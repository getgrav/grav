{% set features = page.header.features ?: [] %}

<section class="features-section">
    <div class="container">
        <div class="section-title-wrapper">
            {% if page.header.label %}
                <span class="section-label">{{ page.header.label }}</span>
            {% endif %}
            {% if page.header.title %}
                <h2 class="section-title">
                    {{ page.header.title }}
                    {% if page.header.title_divider %}
                        <span class="section-title-divider"></span>
                        {{ page.header.title_divider }}
                    {% endif %}
                </h2>
            {% endif %}
            {% if page.header.subtitle %}
                <p class="section-subtitle">{{ page.header.subtitle }}</p>
            {% endif %}
        </div>
        
        {% if features|length > 0 %}
            <div class="features-grid">
                {% for feature in features %}
                    <div class="feature-card">
                        {% if feature.icon %}
                            <div class="feature-icon">
                                <i class="{{ feature.icon }}"></i>
                            </div>
                        {% endif %}
                        {% if feature.title %}
                            <h3>{{ feature.title }}</h3>
                        {% endif %}
                        {% if feature.description %}
                            <p>{{ feature.description }}</p>
                        {% endif %}
                        {% if feature.link %}
                            <a href="{{ feature.link.url }}" class="learn-more">
                                {{ feature.link.text|default('Learn More') }}
                                <i class="fas fa-arrow-right"></i>
                            </a>
                        {% endif %}
                    </div>
                {% endfor %}
            </div>
        {% endif %}
        
        {# Only render raw markdown content, not processed template output #}
        {% if page.content and page.content|trim|slice(0, 1) != '<' %}
            {{ page.content|raw }}
        {% endif %}
    </div>
</section>

